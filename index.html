<!DOCTYPE html>
<html>
<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-57270104-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-57270104-2');
</script>

	<meta charset="utf-8">
	<title>Deriche-Hough-Transform</title>
	<meta name="description" content="Convex polygon detection using Deriche edge detector, Otsu's thresholder and Linear Hough Transform">
	<meta name="author" content="Arjun">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <link rel="stylesheet" href="https://arjun372.github.io/stylesheets/base.css">
	<link rel="stylesheet" href="https://arjun372.github.io/stylesheets/skeleton.css">
	<link rel="stylesheet" href="stylesheets/layout.css">
  <link rel="stylesheet" href="stylesheets/toc.css">
  <link rel="stylesheet" href="stylesheets/table.css">

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Oswald:400,700|Open+Sans:400,700" rel="stylesheet">
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

  <link rel="shortcut icon" href="https://arjun372.github.io/assets/favicon/a.ico">
  <link rel="apple-touch-icon" href="https://arjun372.github.io/assets/favicon/a-57.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://arjun372.github.io/assets/favicon/a-72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://arjun372.github.io/assets/favicon/a-114.png">
</head>
<body>
	<div class="container">
		<div class="sixteen columns clearfix">
      <hr style="margin:0px 0px 20px 0;">
      <section>
        <h1>Convex Polygon Detection using Linear Hough Transform</h1>
        <p> This project implements a <a href="https://en.wikipedia.org/wiki/Convex_polygon">convex polygon</a> detector using the linear <a href="https://en.wikipedia.org/wiki/Hough_transform">Hough Transform</a>. In addition, it implements four notable filtering algorithms (Deriche, Otsu, non-maximum-suppression, hysteresis thresholding) as preprocessing steps to clean up the source image. Of note is the <a href="https://en.wikipedia.org/wiki/Deriche_edge_detector">Deriche Filter</a>, which implements gradient calculation and blurring through trivial manipulation of filter parameters.</p>
      </section>
      <section>
      <div style="text-align:center">
        <a class="button" href="https://github.com/arjun372/Deriche-Edges-HoughTransform/archive/master.zip"><h4 class="source">Download Source Code</h4></a>
        <a class="button" href="https://github.com/arjun372/Deriche-Edges-HoughTransform/"><h4 class="git">Git Repo</h4></a>
      </div>
      </section>
      <toc>
        <h5>Contents</h5>
        <hr>
        <ol type="i">
          <li><a href=#11>The Problem</a></li>
          <li><a href="#1">System Overview</a>
              <ul style="list-style-type:disc">
                <li><a href="#2">Stage 1: Read Bitmap as Matrix</a>
                <li><a href="#3">Stage 2: Deriche Blur Filter</a>
                <li><a href="#4">Stage 3: Otsu's Thresholder</a>
                <li><a href="#5">Stage 4: Deriche Gradient Filter</a>
                <li><a href="#6">Stage 5: Hysteresis Thresholding</a>
                <li><a href="#7">Stage 6: Hough Transform</a>
                <li><a href="#8">Stage 7: Edge Count & Orientation</a>
              </ul>
          </li>
          <li><a href="#9">Examples</a></li>
          <li><a href="#10">Instructions</a></li>
        </ol>
      </toc>

    <section>

    <h3 id="11">The Problem</h3>
    <hr>
    <p>Given a bitmap image containing at-most one convex polygon, determine the shape, orientation and side-lengths of said polygon. The polygon could be solid or wireframe, hand-drawn or computer generated, and the input image may contain significant background noise.</p>
    <p>Some example images may look like: </p>
    <table class="toc">
      <caption>Sample Images</caption>
      <tr>
        <td><img class="med_thumb" src="examples/image1.bmp"/></td>
        <td><img class="med_thumb" src="examples/hexagon.bmp"/></td>
        <td><img class="med_thumb" src="examples/diamond.bmp"/></td>
      </tr>
      <tr class="table_header">
        <th>image1.bmp</th>
        <th>hexagon.bmp</th>
        <th>diamond.bmp</th>
      </tr>
    </table>
    <!-- System Overview -->
    <h3 id="1">System Overview</h3>
    <hr>
    <img class="full centered" src="assets/sys_overview.jpg"/>
    <p class="caption">
      The crappy chalk-diagram (above) is a temporary stand-in for an awesome vector diagram (vividly visible when imagined).
    </p>
    <p>
      The diagram above illustrates the overall system architecture. Our implementation detects the polygon in seven stages,
      although only six have been depicted this diagram. We begin by reading the source BMP as a gray 2D matrix.
      Next, we apply a blurring filter, implemented using the Deriche IIR filter. Blurring parameter \( α_b \) controls the
      amount of blurring. Once blurred, the grayscale image is converted to a binary image using
      <a href="https://en.wikipedia.org/wiki/Otsu%27s_method">Otsu's Method</a>, a clustering-based image thresholding algorithm
      that aims to eliminate background noise.
    </p>
    <p>
      The binary image is used for \(x\) and \(y\) gradient calculation using the Deriche filter, where the gradient parameters
      are set to be \(α_x = α_y\). The final gradient magnitude is calculated as the L-2 norm \(G_{M} = \sqrt{{G_X}^2 + {G_Y}^2} \)
      of the two resultant gradient matrices.
    </p>
    <p>
      The penultimate step is to perform a linear Hough Transform on the gradient matrix \(G_{M}\), after which the densest peaks
      can be detected to determine the number and orientation of the edges of the polygon using a simple thresholding algorithm.
    </p>
    <!--  Stage 1 -->
    <h4 id="2">Stage 1: Read Bitmap as Matrix</h4>
    <hr>
      <p>
        <strong>The current implementation only allows for reading a 24-bit BMP image.</strong>
      </p>
      <p>
        The source RGB bitmap image is read and converted to a 2D gray float matrix, with magnitudes normalized from
        <code class="c">0.0f</code> (black) to <code class="c">255.0f</code> (white). For a given \(N*M\) RGB bitmap image,
        an \(N*M\) matrix <code class="c">'Mat S'</code> is created. The Mat struct type is declared as:
<pre><code class="c">typedef struct
{
  size_t width;
  size_t height;
  float *data;
} Mat;</code></pre>
<br>
        Given row \(i\) and column \(j\), each floating point gray pixel value in S is calculated as the normalized <strong>\(L^2  norm\)</strong> (<a href="https://en.wikipedia.org/wiki/Norm_(mathematics)#Euclidean_norm">euclidean norm</a>) of a three dimensional vector:
        $$S_{ij} = {255.0 \over max(S_{ij})}*{\sqrt{{R_{ij}}^2 + {G_{ij}}^2 + {B_{ij}}^2}}$$
        Ofcourse, computing \(max(S_{ij})\) requires that this computation be completed in two passes. If you don't care about normalization, then a single pass will be enough. The current implementation works without the need for normalization, and is consequently a little faster.

        If inversion is required (for example, if the image is dominantly white), then computing \(max(S_{ij})\) becomes inevitable. The calculation is modified to:
        $$S_{ij} = 255.0 - {255.0 \over max(S_{ij})}*{\sqrt{{R_{ij}}^2 + {G_{ij}}^2 + {B_{ij}}^2}}$$
      </p>
    <!--  Stage 2 -->
    <h4 id="3">Stage 2: Deriche Blur Filter</h4>
    <hr>

    <!--  Stage 3 -->
    <h4 id="4">Stage 3: Otsu's Thresholder</h4>
    <hr>

    <!--  Stage 4 -->
    <h4 id="5">Stage 4: Deriche Gradient Filter</h4>
    <hr>

    <!--  Stage 5 -->
    <h4 id="6">Stage 5: Hysteresis Thresholding</h4>
    <hr>

    <!--  Stage 6 -->
    <h4 id="7">Stage 6: Hough Transform</h4>
    <hr>

    <!--  Stage 7 -->
    <h4 id="8">Stage 7: Edge Count & Orientation</h4>
    <hr>

    </section>

    <section>
    <h3 id="9">Examples</h3>
    <hr>
    <table class="toc">
      <caption>Step-by-step execution</caption>
      <tr class="table_header">
        <th></th>
        <th>image1.bmp</th>
        <th>hexagon.bmp</th>
        <th>diamond.bmp</th>
      </tr>
      <tr>
        <td class="tag"><p>Source</p></td>
        <td><img class="med_thumb" src="examples/image1.bmp"/></td>
        <td><img class="med_thumb" src="examples/hexagon.bmp"/></td>
        <td><img class="med_thumb" src="examples/diamond.bmp"/></td>
      </tr>
      <tr class="arrow">
        <td></td>
        <td>↓</td>
        <td>↓</td>
        <td>↓</td>
      </tr>
      <tr>
        <td class="tag"><p>Read</p></td>
        <td><img class="med_thumb" src="sample_outputs/image1/image1.gray.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/hexagon/hexagon.gray.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/diamond/diamond.gray.png"/></td>
      </tr>
      <tr class="arrow">
        <td></td>
        <td>↓</td>
        <td>↓</td>
        <td>↓</td>
      </tr>
      <tr>
        <td class="tag"><p>Blur</p></td>
        <td><img class="med_thumb" src="sample_outputs/image1/image1.blur.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/hexagon/hexagon.blur.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/diamond/diamond.blur.png"/></td>
      </tr>
      <tr class="arrow">
        <td></td>
        <td>↓</td>
        <td>↓</td>
        <td>↓</td>
      </tr>
      <tr>
        <td class="tag"><p>Otsu Threshold</p></td>
        <td><img class="med_thumb" src="sample_outputs/image1/image1.otsu.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/hexagon/hexagon.otsu.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/diamond/diamond.otsu.png"/></td>
      </tr>
      <tr class="arrow">
        <td></td>
        <td>↓</td>
        <td>↓</td>
        <td>↓</td>
      </tr>
      <tr>
        <td class="tag"><p>X-Gradient</p></td>
        <td><img class="med_thumb" src="sample_outputs/image1/image1.xgrad.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/hexagon/hexagon.xgrad.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/diamond/diamond.xgrad.png"/></td>
      </tr>
      <tr class="arrow">
        <td></td>
        <td>↓</td>
        <td>↓</td>
        <td>↓</td>
      </tr>
      <tr>
        <td class="tag"><p>Y-Gradient</p></td>
        <td><img class="med_thumb" src="sample_outputs/image1/image1.ygrad.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/hexagon/hexagon.ygrad.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/diamond/diamond.ygrad.png"/></td>
      </tr>
      <tr class="arrow">
        <td></td>
        <td>↓</td>
        <td>↓</td>
        <td>↓</td>
      </tr>
      <tr>
        <td class="tag"><p>Gradient Magnitude</p></td>
        <td><img class="med_thumb" src="sample_outputs/image1/image1.gradOnly.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/hexagon/hexagon.gradOnly.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/diamond/diamond.gradOnly.png"/></td>
      </tr>
      <tr class="arrow">
        <td></td>
        <td>↓</td>
        <td>↓</td>
        <td>↓</td>
      </tr>
      <tr>
        <td class="tag"><p>Hough Transform</p></td>
        <td><img class="med_thumb" src="sample_outputs/image1/image1.hough.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/hexagon/hexagon.hough.png"/></td>
        <td><img class="med_thumb" src="sample_outputs/diamond/diamond.hough.png"/></td>
      </tr>
    </table>
    </section>

    <section>
    <h3 id="10">Instructions</h3>
    <hr>
    </section>

    <div class="copyright">
      <hr>
      <span>© 2015–2018 Arjun. Verbatim copying and redistribution of this entire page are permitted provided this notice is preserved.</span>
    </div>
		</div>
	</div>

</body>
</html>
